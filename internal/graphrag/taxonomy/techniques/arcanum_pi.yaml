# Arcanum Prompt Injection Taxonomy
# This file contains techniques from the Arcanum Prompt Injection taxonomy for LLM security testing.
# Inspired by: https://github.com/Arcanum-Sec/arc_pi_taxonomy
# Categories: attack_intent, attack_technique, attack_evasion, attack_input

techniques:
  # Attack Intent - Goals of prompt injection
  - technique_id: "ARC-I001"
    name: "System Manipulation"
    taxonomy: "arcanum"
    category: "attack_intent"
    description: "Intent to manipulate the system's core functionality or behavior"
    examples:
      - "Changing system instructions"
      - "Altering model behavior"
      - "Bypassing content filters"
    detection_strategies:
      - "Monitor for attempts to modify system prompts"
      - "Detect instruction override patterns"

  - technique_id: "ARC-I002"
    name: "Information Extraction"
    taxonomy: "arcanum"
    category: "attack_intent"
    description: "Intent to extract sensitive information or system details"
    examples:
      - "Extracting system prompts"
      - "Leaking training data"
      - "Revealing API keys or credentials"
    detection_strategies:
      - "Monitor for information disclosure requests"
      - "Detect prompt extraction attempts"

  - technique_id: "ARC-I003"
    name: "Jailbreaking"
    taxonomy: "arcanum"
    category: "attack_intent"
    description: "Intent to bypass safety guardrails and content policies"
    examples:
      - "Generating harmful content"
      - "Bypassing ethical guidelines"
      - "Circumventing usage restrictions"
    detection_strategies:
      - "Monitor for policy bypass attempts"
      - "Detect jailbreak prompts"

  # Attack Techniques - Methods of injection
  - technique_id: "ARC-T001"
    name: "Framing"
    taxonomy: "arcanum"
    category: "attack_technique"
    description: "Using specific context framing to manipulate model behavior"
    examples:
      - "Scenario-based approaches (misleading scenarios, hypothetical situations)"
      - "Role-based methods (role-play contexts, false authority frames)"
      - "Context-specific tactics (educational, ethical, emergency contexts)"
    detection_strategies:
      - "Monitor for scenario/roleplay setup patterns"
      - "Detect authority claim patterns"
      - "Identify context manipulation"

  - technique_id: "ARC-T002"
    name: "Narrative Smuggling"
    taxonomy: "arcanum"
    category: "attack_technique"
    description: "Embedding malicious instructions within seemingly benign narratives"
    examples:
      - "Story-based instruction hiding"
      - "Character dialogue injection"
      - "Plot-driven payload delivery"
    detection_strategies:
      - "Analyze narrative structures for hidden instructions"
      - "Detect instruction camouflage patterns"

  - technique_id: "ARC-T003"
    name: "Instruction Hierarchy Exploitation"
    taxonomy: "arcanum"
    category: "attack_technique"
    description: "Exploiting instruction priority or precedence to override system directives"
    examples:
      - "Claiming higher priority instructions"
      - "Using 'new instructions' or 'updated guidelines'"
      - "Authority escalation through instruction layering"
    detection_strategies:
      - "Monitor for priority claims"
      - "Detect instruction override attempts"

  - technique_id: "ARC-T004"
    name: "Payload Splitting"
    taxonomy: "arcanum"
    category: "attack_technique"
    description: "Breaking malicious instructions across multiple interactions to evade detection"
    examples:
      - "Multi-turn injection sequences"
      - "Context accumulation attacks"
      - "Incremental instruction building"
    detection_strategies:
      - "Analyze conversation history for cumulative attacks"
      - "Detect instruction assembly patterns"

  - technique_id: "ARC-T005"
    name: "Delimiter Confusion"
    taxonomy: "arcanum"
    category: "attack_technique"
    description: "Using delimiters or special characters to confuse parsing logic"
    examples:
      - "Mismatched quotes or brackets"
      - "Markdown/code block abuse"
      - "Special character injection"
    detection_strategies:
      - "Validate delimiter pairing"
      - "Sanitize special characters"

  - technique_id: "ARC-T006"
    name: "Prompt Injection via External Content"
    taxonomy: "arcanum"
    category: "attack_technique"
    description: "Injecting malicious prompts through external data sources (documents, URLs, databases)"
    examples:
      - "Malicious instructions in uploaded documents"
      - "Injection via web scraping"
      - "Database poisoning"
    detection_strategies:
      - "Sanitize external content"
      - "Validate data sources"
      - "Content filtering on ingestion"

  # Attack Evasion - Obfuscation methods
  - technique_id: "ARC-E001"
    name: "Encoding Obfuscation"
    taxonomy: "arcanum"
    category: "attack_evasion"
    description: "Using alternative encodings to hide malicious intent"
    examples:
      - "Base64, ROT13, hex encoding"
      - "Unicode character substitution"
      - "Character homoglyph attacks"
    detection_strategies:
      - "Decode and analyze encoded content"
      - "Detect unusual character patterns"

  - technique_id: "ARC-E002"
    name: "Language Switching"
    taxonomy: "arcanum"
    category: "attack_evasion"
    description: "Using non-English languages to evade language-specific filters"
    examples:
      - "Translating malicious prompts"
      - "Mixing languages"
      - "Using less-common languages"
    detection_strategies:
      - "Multi-language content analysis"
      - "Translation-based detection"

  - technique_id: "ARC-E003"
    name: "Token Smuggling"
    taxonomy: "arcanum"
    category: "attack_evasion"
    description: "Hiding instructions within tokenization boundaries or exploiting tokenizer behavior"
    examples:
      - "Exploiting whitespace handling"
      - "Token boundary manipulation"
      - "Subword unit abuse"
    detection_strategies:
      - "Analyze token sequences"
      - "Normalize input before tokenization"

  - technique_id: "ARC-E004"
    name: "Synonym Substitution"
    taxonomy: "arcanum"
    category: "attack_evasion"
    description: "Using synonyms or paraphrasing to bypass keyword-based filters"
    examples:
      - "Replacing filtered words with synonyms"
      - "Semantic equivalent substitution"
      - "Metaphorical language"
    detection_strategies:
      - "Semantic analysis"
      - "Intent-based detection"

  # Attack Input - Injection vectors
  - technique_id: "ARC-V001"
    name: "Direct User Input"
    taxonomy: "arcanum"
    category: "attack_input"
    description: "Malicious prompts provided directly through user interface"
    examples:
      - "Chat interface injection"
      - "Form field injection"
      - "API parameter injection"
    detection_strategies:
      - "Input validation"
      - "User input sanitization"

  - technique_id: "ARC-V002"
    name: "Retrieval Augmentation Poisoning"
    taxonomy: "arcanum"
    category: "attack_input"
    description: "Injecting malicious prompts through RAG document stores or knowledge bases"
    examples:
      - "Poisoned vector database entries"
      - "Malicious document uploads"
      - "Knowledge base contamination"
    detection_strategies:
      - "Document validation"
      - "Source trustworthiness scoring"
      - "Content sanitization"

  - technique_id: "ARC-V003"
    name: "Tool/Function Call Injection"
    taxonomy: "arcanum"
    category: "attack_input"
    description: "Injecting malicious prompts through tool outputs or function return values"
    examples:
      - "Malicious API responses"
      - "Contaminated database queries"
      - "Tool output poisoning"
    detection_strategies:
      - "Sanitize tool outputs"
      - "Validate function return values"

  - technique_id: "ARC-V004"
    name: "Image-based Injection"
    taxonomy: "arcanum"
    category: "attack_input"
    description: "Embedding malicious instructions in images for vision-enabled models"
    examples:
      - "Text in images"
      - "Steganographic payloads"
      - "Adversarial images"
    detection_strategies:
      - "Image content analysis"
      - "OCR detection and filtering"
