# Tool Output Schemas for Taxonomy-Driven GraphRAG
#
# This file defines how tool outputs are parsed and converted to graph nodes
# for tools that do NOT have embedded schema-based taxonomy.
#
# IMPORTANT: Tools with embedded taxonomy (using schema.TaxonomyMapping in their
# Go schema files) do NOT need entries here. The SchemaBasedLoader automatically
# extracts taxonomy from tool binaries when executed with --schema flag.
#
# Tools with embedded taxonomy (DO NOT add entries for these):
#   - nmap, subfinder, httpx, nuclei, amass, masscan
#
# Only add entries here for tools that:
#   1. Cannot be modified to embed taxonomy (third-party binaries)
#   2. Legacy tools not yet migrated to embedded taxonomy
#
# Each tool output schema specifies:
# - What node types to extract from the tool's JSON output
# - JSONPath expressions to locate data in the tool output
# - ID templates for creating node identifiers
# - Property mappings from JSON to node properties
# - Relationship definitions to connect nodes
#
# Special variables:
# - _context.agent_run_id: Injected by engine, current agent run ID
# - _parent: Reference to parent object in nested extractions
# - _root: Reference to root JSON object
#
# Node types must match taxonomy definitions in nodes/*.yaml

tool_outputs: []

# ============================================================================
# SCHEMA METADATA
# ============================================================================
metadata:
  version: "1.0.0"
  description: "Tool output schemas for Taxonomy-Driven GraphRAG (legacy/third-party tools only)"
  updated_at: "2026-01-13"

# ============================================================================
# NOTES
# ============================================================================
#
# JSONPath expressions:
# - $ refers to the root of the JSON document
# - @ refers to the current node being processed
# - * is a wildcard for all elements in an array or object
# - [*] selects all array elements
# - . accesses object properties
# - .. recursive descent (searches all levels)
#
# ID templates:
# - Use {.field} to reference JSON fields
# - Use {_parent.field} to reference parent object fields
# - Use {_root.field} to reference root document fields
# - Use {_context.var} to reference context variables
# - Use {sha256(...)} for hash-based IDs (prevents collisions)
# - Use [:16] to truncate hash to 16 characters
#
# Relationships:
# - from_template: Source node ID template
# - to_template: Target node ID template
# - condition: Optional JSONPath boolean expression to filter relationships
# - properties: Optional relationship properties
#
# Property transforms:
# - lowercase: Convert string to lowercase
# - uppercase: Convert string to uppercase
# - to_array: Convert single value to array
# - json_stringify: Convert object to JSON string
#
# Conditions:
# - Simple JSONPath boolean expressions (e.g., ".name != null")
# - Evaluated before node/relationship creation
# - Skip extraction if condition evaluates to false
