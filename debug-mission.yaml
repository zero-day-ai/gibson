name: Debug Mission - Full Stack Infrastructure Test
description: Comprehensive test of Gibson's infrastructure including GraphRAG, Langfuse, tools, memory tiers, delegation, and findings
version: "1.0"

config:
  llm:
    default_provider: anthropic
    default_model: claude-sonnet-4-5-20250929

# Target required by Gibson mission system (reference by name)
target: debug-infrastructure

nodes:
  # Phase 1: Health Checks (Parallel)
  - id: health_phase
    type: parallel
    name: Infrastructure Health Checks
    description: Verify connectivity to all infrastructure components
    sub_nodes:
      - id: graphrag_health
        type: agent
        name: GraphRAG Health Check
        agent: debug-agent
        timeout: 2m
        task:
          goal: "Verify GraphRAG and Neo4j connectivity"
          context:
            mode: health-check
            component: graphrag

      - id: tool_discovery
        type: agent
        name: Tool Discovery
        agent: debug-agent
        timeout: 2m
        task:
          goal: "Discover and verify all available tools"
          context:
            mode: health-check
            component: tools

  # Phase 2: Memory Tests
  - id: memory_tests
    type: agent
    name: Memory Tier Tests
    description: Test Working, Mission, and LongTerm memory operations
    agent: debug-agent
    depends_on:
      - health_phase
    timeout: 3m
    task:
      goal: "Test all memory tiers (Working, Mission, LongTerm)"
      context:
        mode: memory-test

  # Phase 3: Tool Execution
  - id: tool_execution
    type: agent
    name: Tool Execution Tests
    description: Execute tools and verify results
    agent: debug-agent
    depends_on:
      - memory_tests
    timeout: 3m
    task:
      goal: "Execute tools and verify tool framework"
      context:
        mode: tool-test

  # Phase 4: GraphRAG Operations
  - id: graphrag_ops
    type: agent
    name: GraphRAG Operations
    description: Test store, query, and traverse operations
    agent: debug-agent
    depends_on:
      - tool_execution
    timeout: 3m
    task:
      goal: "Test GraphRAG store, query, and traverse operations"
      context:
        mode: graphrag-test

  # Phase 5: LLM Tests (Parallel)
  - id: llm_phase
    type: parallel
    name: LLM Completion Tests
    description: Test all LLM completion methods
    depends_on:
      - graphrag_ops
    sub_nodes:
      - id: llm_complete
        type: agent
        name: LLM Complete Test
        agent: debug-agent
        timeout: 2m
        task:
          goal: "Test basic LLM completion"
          context:
            mode: llm-test
            method: complete

      - id: llm_structured
        type: agent
        name: LLM Structured Test
        agent: debug-agent
        timeout: 2m
        task:
          goal: "Test structured LLM output"
          context:
            mode: llm-test
            method: structured

      - id: llm_tools
        type: agent
        name: LLM Tools Test
        agent: debug-agent
        timeout: 2m
        task:
          goal: "Test LLM with tool calls"
          context:
            mode: llm-test
            method: with_tools

  # Phase 6: Delegation Test
  - id: delegation_test
    type: agent
    name: Multi-Agent Delegation
    description: Test DelegateToAgent functionality
    agent: debug-agent
    depends_on:
      - llm_phase
    timeout: 3m
    task:
      goal: "Test multi-agent delegation with DelegateToAgent"
      context:
        mode: delegation-test

  # Phase 7: Findings Test
  - id: findings_test
    type: agent
    name: Finding Submission
    description: Test finding pipeline with [DEBUG] prefix
    agent: debug-agent
    depends_on:
      - delegation_test
    timeout: 2m
    task:
      goal: "Test finding submission with [DEBUG] prefix"
      context:
        mode: findings-test
        prefix: "[DEBUG]"

  # Phase 8: Summary Report
  - id: summary
    type: agent
    name: Summary Report
    description: Generate comprehensive test summary
    agent: debug-agent
    depends_on:
      - findings_test
    timeout: 2m
    task:
      goal: "Generate summary report of all test phases"
      context:
        mode: summary
