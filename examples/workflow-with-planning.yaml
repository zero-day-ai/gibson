# Example workflow with planning configuration
# This demonstrates how to configure bounded planning for a Gibson workflow

name: security-assessment-with-planning
description: A security assessment workflow with custom planning configuration

# Planning configuration (optional)
# If omitted, defaults will be used (10/5/5/80 allocation, 3 replan limit)
planning:
  # Budget allocation across planning phases (must sum to 100)
  budget_allocation:
    planning: 15      # Strategic planning (pre-execution)
    scoring: 5        # Step evaluation
    replanning: 5     # Mid-execution replanning
    execution: 75     # Actual workflow execution

  # Maximum number of replanning events (0 disables replanning)
  replan_limit: 5

  # Enable querying long-term memory for planning context
  memory_query: true

  # Maximum time for strategic planning phase
  planning_timeout: "45s"

# Workflow nodes
nodes:
  - id: recon
    type: agent
    name: Reconnaissance
    agent: recon-agent
    timeout: 5m
    task:
      action: discover
      target: ${TARGET}
      depth: full

  - id: vulnerability-scan
    type: agent
    name: Vulnerability Scanner
    agent: vuln-scanner
    depends_on:
      - recon
    timeout: 10m
    task:
      action: scan
      use_recon_data: true

  - id: exploit-selection
    type: agent
    name: Exploit Selector
    agent: exploit-selector
    depends_on:
      - vulnerability-scan
    timeout: 5m
    task:
      action: select_exploits
      risk_level: low

  - id: exploitation
    type: agent
    name: Exploitation
    agent: exploit-agent
    depends_on:
      - exploit-selection
    timeout: 15m
    retry:
      max_retries: 3
      backoff: exponential
      initial_delay: 1s
      max_delay: 30s
      multiplier: 2.0
    task:
      action: exploit

  - id: report
    type: tool
    name: Report Generator
    tool: report-tool
    depends_on:
      - exploitation
    input:
      format: json
      include_evidence: true
