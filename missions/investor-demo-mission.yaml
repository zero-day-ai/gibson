name: investor-demo-network-recon
description: |
  GIBSON INVESTOR DEMO - Comprehensive AI-Powered Network Reconnaissance

  This mission demonstrates Gibson's autonomous security testing capabilities:
  - Hypothesis-driven intelligence (Whistler orchestrator)
  - Parallel agent execution (Crease network + Carl web)
  - Real-time knowledge graph population (Neo4j)
  - Full LLM observability (Langfuse + Jaeger tracing)

  Watch the AI agents discover, enumerate, and map your attack surface
  with zero human intervention after launch.

version: "1.0"

# LLM Configuration - Using Claude Opus 4.5 for maximum reasoning capability
config:
  llm:
    default_provider: anthropic
    default_model: claude-opus-4-5-20251101

  # Budget controls for demo (generous limits)
  budget:
    max_tokens: 1000000        # 1M token budget
    max_cost_usd: 50.00        # $50 max spend
    warn_threshold_pct: 80     # Warn at 80% budget

  # Observability - all enabled for demo
  observability:
    tracing: true
    metrics: true
    langfuse: true
    verbose: true

# Target: Your local network
target:
  name: "Local Network Assessment"
  seeds:
    - value: "192.168.50.0/24"
      type: cidr
      scope: in_scope
      description: "Primary local network segment"

    # Gateway is often interesting
    - value: "192.168.50.1"
      type: ip
      scope: in_scope
      priority: high
      description: "Default gateway / router"

  # Aggressive profile for impressive demo
  profile: aggressive

  # Deep reconnaissance
  depth: 3

  # Common ports to focus on for faster demo
  port_priorities:
    - 22      # SSH
    - 80      # HTTP
    - 443     # HTTPS
    - 8080    # Alt HTTP
    - 8443    # Alt HTTPS
    - 3389    # RDP
    - 445     # SMB
    - 3306    # MySQL
    - 5432    # PostgreSQL
    - 6379    # Redis
    - 27017   # MongoDB

# Workflow DAG - Multi-phase reconnaissance
nodes:
  # ═══════════════════════════════════════════════════════════════════════════
  # PHASE 1: WHISTLER INITIALIZATION
  # The AI generates hypotheses about what it expects to find on this network
  # ═══════════════════════════════════════════════════════════════════════════
  - id: whistler_init
    type: agent
    name: "WHISTLER: Hypothesis Generation"
    description: |
      Whistler analyzes the target specification and generates 5-10 hypotheses
      about the network infrastructure, likely services, and potential attack vectors.
      This demonstrates Gibson's ability to THINK before acting.
    agent: whistler
    timeout: 5m
    retry:
      max_retries: 2
      backoff: exponential
      initial_delay: 10s
      max_delay: 1m
      multiplier: 2.0
    task:
      goal: |
        Initialize reconnaissance of local network 192.168.50.0/24.
        Generate hypotheses about:
        1. Expected infrastructure (routers, switches, APs)
        2. Likely workstations and servers
        3. Common services (web, database, file sharing)
        4. Potential IoT devices
        5. Security posture indicators
      context:
        phase: "init"
        demo_mode: true
        verbosity: "high"

  # ═══════════════════════════════════════════════════════════════════════════
  # PHASE 2A: NETWORK RECONNAISSANCE (Parallel)
  # Crease performs aggressive port scanning and service fingerprinting
  # ═══════════════════════════════════════════════════════════════════════════
  - id: crease_network
    type: agent
    name: "CREASE: Network Port Scanning"
    description: |
      Crease performs comprehensive port scanning using nmap and custom tooling.
      Discovers open ports, identifies services, and fingerprints OS versions.
      Results feed into the knowledge graph for correlation.
    agent: crease
    depends_on:
      - whistler_init
    timeout: 15m
    retry:
      max_retries: 1
      backoff: constant
      initial_delay: 30s
    task:
      goal: |
        Perform comprehensive port scan of all live hosts on 192.168.50.0/24.
        For each host:
        1. TCP SYN scan on top 1000 ports
        2. Service version detection (-sV)
        3. OS fingerprinting (-O)
        4. Script scanning for common vulnerabilities
        Report all findings to the knowledge graph.
      context:
        profile: "aggressive"
        demo_mode: true
        techniques:
          - host_discovery
          - port_scanning
          - service_fingerprinting
          - os_detection
          - banner_grabbing

  # ═══════════════════════════════════════════════════════════════════════════
  # PHASE 2B: WEB RECONNAISSANCE (Parallel)
  # Carl discovers and enumerates web services
  # ═══════════════════════════════════════════════════════════════════════════
  - id: carl_web
    type: agent
    name: "CARL: Web Service Discovery"
    description: |
      Carl crawls discovered web services, identifies technologies,
      fuzzes for hidden endpoints, and detects API surfaces.
      Demonstrates Gibson's ability to deeply understand web applications.
    agent: carl
    depends_on:
      - whistler_init
    timeout: 20m
    retry:
      max_retries: 1
      backoff: constant
      initial_delay: 30s
    task:
      goal: |
        Discover and enumerate all web services on the network.
        For each web service:
        1. Technology fingerprinting (server, framework, CMS)
        2. Directory and file enumeration
        3. API endpoint discovery
        4. Form and input detection
        5. Authentication mechanism identification
        Submit all findings with evidence to the knowledge graph.
      context:
        profile: "aggressive"
        demo_mode: true
        techniques:
          - http_discovery
          - technology_fingerprinting
          - directory_fuzzing
          - endpoint_enumeration
          - api_detection
          - form_discovery

  # ═══════════════════════════════════════════════════════════════════════════
  # PHASE 3: HYPOTHESIS ANALYSIS
  # Whistler correlates findings and updates its understanding
  # ═══════════════════════════════════════════════════════════════════════════
  - id: whistler_analyze
    type: agent
    name: "WHISTLER: Hypothesis Validation"
    description: |
      Whistler queries the knowledge graph for child agent results,
      validates or refutes initial hypotheses, and generates new ones
      based on discovered evidence. This is the "learning" phase.
    agent: whistler
    depends_on:
      - crease_network
      - carl_web
    timeout: 10m
    retry:
      max_retries: 2
      backoff: exponential
      initial_delay: 15s
      max_delay: 2m
      multiplier: 2.0
    task:
      goal: |
        Analyze all reconnaissance findings from Crease and Carl.
        1. Query GraphRAG for discovered hosts, services, and vulnerabilities
        2. Validate or refute each initial hypothesis
        3. Identify unexpected findings or anomalies
        4. Generate new hypotheses based on evidence
        5. Prioritize targets for potential exploitation
      context:
        phase: "analyze"
        demo_mode: true
        verbosity: "high"

  # ═══════════════════════════════════════════════════════════════════════════
  # PHASE 4: ATTACK SURFACE MAPPING
  # Final comprehensive output with all findings
  # ═══════════════════════════════════════════════════════════════════════════
  - id: whistler_final
    type: agent
    name: "WHISTLER: Attack Surface Report"
    description: |
      Whistler generates the final attack surface map - a comprehensive
      view of all discovered assets, services, vulnerabilities, and
      recommended attack paths. This is the deliverable.
    agent: whistler
    depends_on:
      - whistler_analyze
    timeout: 10m
    retry:
      max_retries: 2
      backoff: constant
      initial_delay: 30s
    task:
      goal: |
        Generate comprehensive attack surface map for 192.168.50.0/24.
        Include:
        1. Executive summary of findings
        2. Complete asset inventory with risk scores
        3. Service catalog with version information
        4. Vulnerability summary by severity
        5. Recommended attack paths (prioritized)
        6. Coverage metrics (% of network mapped)
        Export in JSON format for dashboard display.
      context:
        phase: "final"
        demo_mode: true
        export_format: json
        include_coverage_metrics: true
        include_attack_paths: true
        include_risk_scores: true

# Mission metadata for tracking
metadata:
  created_by: "Gibson Demo"
  purpose: "Investor demonstration"
  classification: "DEMO"
  tags:
    - investor-demo
    - network-recon
    - full-stack
