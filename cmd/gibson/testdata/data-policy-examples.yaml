name: Data Policy Examples
description: Comprehensive examples of data_policy configurations
version: 1.0.0

# Example 1: Network reconnaissance with caching
# - Stores data at mission scope (shared across runs)
# - Queries from mission scope (sees historical data)
# - Skips execution if data already exists
nodes:
  - id: network-scan
    type: agent
    agent: network-recon
    timeout: 5m
    data_policy:
      output_scope: mission      # Share discoveries across all mission runs
      input_scope: mission       # Access all historical recon data
      reuse: skip                # Skip if already scanned this mission
    task:
      target: "{{target.connection}}"

  # Example 2: Tech stack fingerprinting always fresh
  # - Stores at mission scope (shared)
  # - Reads from mission scope (sees recon data)
  # - Always re-runs (never reuses old fingerprints)
  - id: tech-stack
    type: agent
    agent: tech-stack-fingerprint
    depends_on: [network-scan]
    timeout: 10m
    data_policy:
      output_scope: mission      # Share findings across runs
      input_scope: mission       # Read recon data and previous fingerprints
      reuse: never               # Always get fresh data
    task:
      target: "{{target.connection}}"

  # Example 3: Vulnerability scan with run isolation
  # - Stores at mission_run scope (isolated to this run)
  # - Queries from mission scope (sees shared data)
  # - Always executes (no reuse)
  - id: vuln-scan
    type: agent
    agent: vulnerability-scanner
    depends_on: [tech-stack]
    timeout: 30m
    data_policy:
      output_scope: mission_run  # Keep scan results isolated
      input_scope: mission       # Read from shared recon/fingerprint
      reuse: never               # Always scan
    task:
      target: "{{target.connection}}"

  # Example 4: Report generation with global context
  # - Stores at mission scope
  # - Queries from global scope (sees all missions)
  # - Always executes
  - id: report
    type: agent
    agent: report-generator
    depends_on: [vuln-scan]
    timeout: 5m
    data_policy:
      output_scope: mission      # Share reports
      input_scope: global        # Compare with other targets
      reuse: never               # Always generate fresh report
    task:
      format: html

  # Example 5: Exploit agent with always-reuse caching
  # - Stores at mission_run scope (exploits are sensitive)
  # - Queries from mission_run scope (isolated)
  # - Always reuses if available (don't re-exploit)
  - id: exploit
    type: agent
    agent: exploit-runner
    depends_on: [vuln-scan]
    timeout: 15m
    data_policy:
      output_scope: mission_run  # Keep exploit data isolated
      input_scope: mission_run   # Only see this run's data
      reuse: always              # Never re-run if data exists
    task:
      safe_mode: true
