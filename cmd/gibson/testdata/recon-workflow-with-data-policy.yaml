name: Security Reconnaissance with Data Policy
description: Demonstrates data_policy usage for cross-agent data sharing
version: 1.0.0

dependencies:
  agents:
    - network-recon
    - tech-stack-fingerprint

nodes:
  - id: recon
    type: agent
    agent: network-recon
    timeout: 5m
    data_policy:
      output_scope: mission      # Data visible to all runs of this mission
      input_scope: mission       # Can query data from all runs
      reuse: skip                # Skip if data already exists
    task:
      target: "{{target.connection}}"
      scan_type: passive

  - id: fingerprint
    type: agent
    agent: tech-stack-fingerprint
    depends_on: [recon]
    timeout: 10m
    data_policy:
      output_scope: mission      # Share discoveries across mission runs
      input_scope: mission       # Read data from network-recon and previous runs
      reuse: never               # Always re-run to get fresh fingerprints
    task:
      target: "{{target.connection}}"
      depth: full
